<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Accelerometer Data Logger</title>
</head>
<body>

<button onclick="startLogging()">Start Logging</button>
<button onclick="stopLogging()">Stop Logging</button>

<script>
let accelerometerData = [];
let loggingInterval;

function startLogging() {
  if (window.DeviceMotionEvent) {
    loggingInterval = setInterval(logAccelerometerData, 1000); // Log data every second
  } else {
    alert("Accelerometer not supported on this device/browser.");
  }
}

function stopLogging() {
  clearInterval(loggingInterval);
  downloadCSV();
}

function logAccelerometerData() {
  if (window.DeviceMotionEvent) {
    window.addEventListener('devicemotion', function(event) {
      const acceleration = event.acceleration;
      const timestamp = new Date().toISOString();

      accelerometerData.push({
        timestamp: timestamp,
        x: acceleration.x,
        y: acceleration.y,
        z: acceleration.z
      });
    });
  }
}

function downloadCSV() {
  const csvContent = "data:text/csv;charset=utf-8," +
    "Timestamp,X,Y,Z\n" +
    accelerometerData.map(data => `${data.timestamp},${data.x},${data.y},${data.z}`).join("\n");

  const encodedUri = encodeURI(csvContent);
  const link = document.createElement("a");
  link.setAttribute("href", encodedUri);
  link.setAttribute("download", "accelerometer_data.csv");
  document.body.appendChild(link); // Required for Firefox
  link.click();
}

</script>

</body>
</html>
